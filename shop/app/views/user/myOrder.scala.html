@(page:common.utils.page.Page[ordercenter.models.Order],queryType:Int)

@import ordercenter.constants.OrderState;
@import common.utils.DateUtils;

@myCenter(Messages("title.my.order")) {
    <script src="@routes.Assets.versioned("js/FormValidate.js")"></script>
} {

    <!--order-manage-->
    <div class="order-manage">
        <div class="order-manage-inner width1200">
            <div class="bread-nav">
                <ul class="clearfix">
                    <li><a href="index.html">首页</a></li>
                    <li>&gt;</li>
                    <li><a href="index.html">个人中心</a></li>
                    <li>&gt;</li>
                    <li>订单管理</li>
                </ul>
            </div>
            <div class="order-manage-container clearfix">
                @left("order")
                    <!-- order-list -->
                <div class="all-order-list">
                    <div class="order-status">
                        <ul class="clearfix">
                            <li @if(queryType == 0){ class="current" }><a href="@controllers.user.routes.MyOrderController.index()">所有订单</a></li>
                            <li @if(queryType == 1){ class="current" }><a href="@controllers.user.routes.MyOrderController.index(1)">待收货</a></li>
                            <li @if(queryType == 2){ class="current" }><a href="@controllers.user.routes.MyOrderController.index(2)">待评价</a></li>
                        </ul>
                    </div>
                    @if(page.getResult.size() > 0){
                        <div class="order-list">
                            <table>
                                <thead>
                                    <tr>
                                        <th colspan="3">商品</th>
                                        <th colspan="">订单金额</th>
                                        <th colspan="">订单状态</th>
                                        <th colspan="">操作</th>
                                    </tr>
                                </thead>
                                @for(order <- page.getResult) {
                                    <tbody>
                                        <tr class="space-row"><td colspan="6"></td></tr>
                                        <tr class="order-hd">
                                            <td class="order-hd-first">订单号：<span class="order-number">@order.getOrderNo</span></td>
                                            <td>收货人：<span class="user">@order.getAddressName</span></td>
                                            <td colspan="4" class="order-hd-last">下单时间：<span class="order-time">@DateUtils.printDateTime(order.getCreateTime)</span></td>
                                        </tr>

                                        @for((orderItem, index) <- order.getOrderItemList.zipWithIndex){
                                            @if(index+1 == order.getOrderItemList.size()){
                                                <tr class="last">
                                                }else{
                                                <tr>
                                                }
                                            <td class="product-img">
                                                <img src="@orderItem.getMainPicture" alt="" height="154px" width="90px"/>
                                            </td>
                                            <td class="product-name">
                                                <p>@orderItem.getProductName</p>
                                            </td>
                                            <td class="product-size">
                                            @for(keyValue <- orderItem.getProperties){
                                                <p>@keyValue.getPropertyName：@keyValue.getPropertyValue</p>
                                            }
                                            </td>

                                            @if(index == 0){
                                                <td rowspan="@order.getOrderItemList.size()" class="product-price">
                                                    ￥@order.getTotalMoney.getAmountWithBigDecimal
                                                </td>
                                                <td rowspan="@order.getOrderItemList.size()" class="order-detail">
                                                    @if(order.getOrderState.getName.equals(OrderState.Create.getName)){
                                                        <p class="not-pay">@order.getOrderState.getValue</p>
                                                    }else{
                                                        <p>@order.getOrderState.getValue</p>
                                                    }
                                                    <p><a href="@controllers.user.routes.MyOrderController.orderContent(order.getId)">订单详情</a></p>
                                                </td>
                                                <td rowspan="@order.getOrderItemList.size()" class="control">
                                                    @if(order.getOrderState.getName.equals(OrderState.Create.getName)){
                                                        <p><a href="#" class="pay">立即付款</a></p>
                                                    }
                                                    @if(order.getOrderState.getName.equals(OrderState.Send.getName)){
                                                        <p><a href="#" class="confirm">确认收货</a></p>
                                                    }
                                                    @if(order.getOrderState.getName.equals(OrderState.Receiving.getName) || order.getOrderState.getName.equals(OrderState.Success.getName)){
                                                        <p><a href="@controllers.user.routes.MyOrderController.orderAppraise(order.getId)" class="confirm">评价</a></p>
                                                    }
                                                    @if(order.getOrderState.getName.equals(OrderState.Create.getName) || order.getOrderState.getName.equals(OrderState.Pay.getName)){
                                                        <p><a href="#" class="cancel">取消</a></p>
                                                    }
                                                    <p><a href="@controllers.user.routes.MyOrderController.backApply(order.getId)" class="confirm">申请退货</a></p>
                                                </td>
                                            }
                                        </tr>
                                        }
                                    </tbody>
                                }
                            </table>

                            @if(page.getTotalPage > 1){
                                <div class="order-page">
                                    <ul class="clearfix">
                                        <li>第<span class="current-page">@page.getPageNo</span>/<span class="total-page">@page.getTotalPage</span>页</li>
                                        @if(page.getPageNo > 1){
                                            <li><a href="@controllers.user.routes.MyOrderController.index(queryType,page.getPageNo-1)">上一页</a></li>
                                        }else{
                                            <li>上一页</li>
                                        }
                                        @if( page.getTotalCount > (page.getPageSize * page.getPageNo) ){
                                            <li><a href="@controllers.user.routes.MyOrderController.index(queryType,page.getPageNo+1)">下一页</a></li>
                                        }else{
                                            <li>下一页</li>
                                        }
                                    </ul>
                                </div>
                            }
                        </div>
                    }else{
                        没有数据
                    }

                </div>
                    <!-- end order-list-->
            </div>
        </div>
    </div>
    <!--end order-manage-->

}


